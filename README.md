# Система блога

## Описание проекта

Этот проект представляет собой систему по размещению статей. Вы можете зарегистрироваться, написать свою статью с определенной категорией, написать комментарий или отзыв к чужой статье, а также оставить жалобу администраторам.

### Возможности пользователя:
- **Регистрация и вход в систему**
- **Написание статей**
- **Написание отзывов**
- **Написание комментариев к статьям**
- **Оставление жалобы на статью**

### Возможности администратора:
- **Все возможности пользователя**
- **Бан/разбан пользователя**
- **Удаление чужих комментариев к статьям**
- **Просмотр жалоб и управление ими**
- **Создание категорий**

## Основные технологии
### (полный список в pyproject.toml)

- **python** = "^3.11"
- **fastapi** = "^0.112.0"
- **alembic** = "^1.13.2"
- **fastapi-users** = "^13.0.0"
- **fastapi-filter** = "^2.0.0"
- **fastapi-pagination** = "^0.12.26"
- **aiohttp** = "^3.10.2"

## Установка и настройка

### Требования

- Docker и Docker Compose

### Шаги установки

1. **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/B4TRUH4/blog
    cd blog
    ```

2. **Настройте файл окружения `.env`:**

    Создайте файл `.env` в корне проекта и добавьте следующие переменные (замените значения на собственные):

    ```env
   DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/postgres
   POSTGRES_DB=postgres
   POSTGRES_USER=postgres
   POSTGRES_PASSWORD=postgres
   
   JWT_SECRET=<SECRET>
   JWT_LIFETIME_SECONDS=6000
   BOT_TOKEN=<Токен_бота_телеграм>
   ADMIN_CHAT_ID=<ID_чата>
    ```
   Опционально вы можете настроить телеграм-бота на отправку сообщений о критических ошибках, используя переменные `BOT_TOKEN` и `ADMIN_CHAT_ID`. ID чата можно получить по ссылке `https://api.telegram.org/bot<BOT_TOKEN>/getUpdates`

3. **Выберите версию проекта:**
   - для запуска prod-версии выполните:
    ```bash
    docker compose -f docker-compose.prod.yaml up --build
    ```
   - для запуска dev-версии выполните:
    ```bash
    docker compose up --build
    ```

## Использование

Для работы с приложением необходимо перейти по ссылке `http://localhost:8000`.

Для создания суперпользователя необходимо сначала зарегистрировать обычного пользователя, а затем вручную в базе данных изменить значение `is_superuser` на `t`.

## API

Серверная часть предоставляет REST API для управления следующими сущностями:

- `/articles/` - статьи (доступна пагинация, фильтрация и сортировка)
- `/articles/{article_id}/comments` - комментарии к статье
- `/articles/{article_id}/reviews` - отзывы на статью
- `/categories/` - категории
- `/reports/` - жалобы
- `/users/` - пользователи

Подробно эндпоинты можно изучить по пути `http://localhost:8000/docs/`. Также доступен файл спецификации [swagger.json](swagger.json)
